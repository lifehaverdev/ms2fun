================================================================================
AGENT PROMPT: Styling and Functionality Fixes + Documentation Consolidation
================================================================================

CONTEXT:

You are fixing styling issues, functionality problems, and consolidating documentation
for the ms2.fun launchpad. The codebase has been fully ported to the new multi-project
system, but there are legacy CULT EXEC styles and behaviors bleeding into other pages,
and some missing features.

CURRENT STATE:

✅ Launchpad transition complete (Phases 1-5)
✅ ERC1155 and ERC404 mock frontends working
✅ New routing system in place
✅ ProjectService and projectStore implemented
⚠️ Legacy CULT EXEC styles affecting other pages
⚠️ Missing features on instance pages
⚠️ Wallet connection issues on home page
⚠️ Documentation scattered across multiple files

YOUR MISSION:

1. Fix styling issues (black background, card heights, fonts)
2. Add missing features (back button, wallet display)
3. Fix wallet connection errors on home page
4. Consolidate documentation into About page
5. Remove backward compatibility dependencies

================================================================================
TASKS
================================================================================

TASK 1: FIX BLACK BACKGROUND ISSUE
-------------------------------------

Problem:
The black background from style.css (body { background-color: var(--bg-darker); })
is affecting all pages, but it should only apply to the CULT EXEC page.

Files to modify:
- style.css (root file)
- src/routes/cultexecs.css (if it exists)

Solution:
1. Remove the global body background from style.css
2. Scope the black background to CULT EXEC page only using a class or route-specific selector
3. Ensure all other pages use the clean white/light background from the design system

Implementation:
```css
/* In style.css - REMOVE or COMMENT OUT: */
/* body {
    background-color: var(--bg-darker);
} */

/* Instead, add to cultexecs.css or scope it: */
.cultexecs-page,
body.cultexecs-active {
    background-color: var(--bg-darker);
    color: var(--text-primary);
}
```

Also check:
- Make sure home.css, project-detail.css, factory-exploration.css, etc. explicitly set
  background-color: var(--color-bg-primary) or white to override any inheritance.

TASK 2: FIX PROJECT CARD HEIGHT UNIFORMITY
-------------------------------------------

Problem:
On the home page, project cards with single-line titles display shorter than cards
with multi-line titles, creating an inconsistent grid.

Files to modify:
- src/routes/home.css
- src/components/ProjectDiscovery/ProjectCard.js (if needed)

Solution:
1. Set a fixed or minimum height for .project-card
2. Use flexbox to ensure consistent card heights
3. Ensure card-title has consistent line-height and min-height

Implementation:
```css
/* In src/routes/home.css */
.project-card {
    /* ... existing styles ... */
    min-height: 400px; /* or use a calculated height */
    display: flex;
    flex-direction: column;
}

.card-title {
    min-height: 3rem; /* Ensure consistent height even for single-line titles */
    line-height: 1.5;
    display: -webkit-box;
    -webkit-line-clamp: 2; /* Limit to 2 lines max */
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.card-description {
    flex-grow: 1; /* Push button to bottom */
    min-height: 4rem; /* Ensure description area has minimum height */
}
```

TASK 3: FIX MONO FONT IN PROJECT HEADER TITLES
-----------------------------------------------

Problem:
The project name in ProjectHeader uses monospace font instead of RedHat font.

Files to modify:
- src/components/ProjectDetail/ProjectHeader.js
- src/routes/project-detail.css

Solution:
1. Ensure .project-name uses var(--font-primary) (RedHatTextVar)
2. Remove any font-family: monospace or font-family: var(--font-mono) from project-name

Implementation:
```css
/* In src/routes/project-detail.css */
.project-name {
    font-family: var(--font-primary);
    font-size: 2rem;
    margin: 0;
    color: #333;
    /* Remove any monospace font references */
}
```

Also check ProjectHeader.js to ensure it's not setting inline styles with monospace.

TASK 4: ADD BACK BUTTON TO INSTANCE PAGES
------------------------------------------

Problem:
Instance pages (ERC404 and ERC1155) don't have a back button to return to the launchpad home.

Files to modify:
- src/components/ProjectDetail/ProjectDetail.js
- src/routes/project-detail.css

Solution:
1. Add a back button at the top of ProjectDetail component
2. Style it consistently with the design system
3. Make it navigate to '/' (home page)

Implementation:
```javascript
// In ProjectDetail.js render() method, add before project-header:
return `
    <div class="project-detail">
        <div class="detail-navigation">
            <button class="back-button" data-ref="back-button">
                ← Back to Launchpad
            </button>
        </div>
        <div class="detail-header-container" data-ref="header-container">
            <!-- ... -->
        </div>
        <!-- ... -->
    </div>
`;
```

```css
/* In project-detail.css */
.detail-navigation {
    margin-bottom: 20px;
}

.back-button {
    background: var(--color-accent);
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: var(--border-radius-md);
    cursor: pointer;
    font-size: var(--font-size-body);
    font-family: var(--font-primary);
    font-weight: var(--font-weight-medium);
    transition: background-color 0.2s;
}

.back-button:hover {
    background: var(--color-accent-hover);
}
```

TASK 5: FIX WALLET CONNECTION DISPLAY AND REMOVE REDUNDANT BUTTONS
-------------------------------------------------------------------

Problem:
1. "Select Wallet" button is redundant on instance pages (user already connected)
2. Wallet button is duplicated
3. Need to show connected wallet info (address, ETH balance) and disconnect option
4. Disconnect should send user back to home page wallet splash

Files to modify:
- src/components/ProjectDetail/ProjectDetail.js
- src/components/ERC1155/EditionGallery.js (if it has wallet button)
- src/components/ERC404/ERC404TradingInterface.js (if it has wallet button)
- src/routes/project-detail.css
- Create: src/components/WalletDisplay/WalletDisplay.js

Solution:
1. Create a new WalletDisplay component that shows:
   - Connected wallet address (truncated)
   - ETH balance
   - Disconnect button
2. Remove WalletConnector from instance pages
3. Add WalletDisplay to ProjectDetail
4. On disconnect, navigate to home page

Implementation:

Create src/components/WalletDisplay/WalletDisplay.js:
```javascript
import { Component } from '../../core/Component.js';
import walletService from '../../services/WalletService.js';
import { eventBus } from '../../core/EventBus.js';

export class WalletDisplay extends Component {
    constructor() {
        super();
        this.state = {
            address: null,
            balance: '0.00',
            loading: true
        };
    }

    async onMount() {
        await this.loadWalletInfo();
        this.setupSubscriptions();
    }

    async loadWalletInfo() {
        if (!walletService.isConnected()) {
            this.setState({ loading: false });
            return;
        }

        try {
            const address = walletService.getAddress();
            // Get ETH balance
            const provider = walletService.ethersProvider;
            if (provider && address) {
                const balance = await provider.getBalance(address);
                const balanceEth = parseFloat(ethers.utils.formatEther(balance)).toFixed(4);
                this.setState({
                    address,
                    balance: balanceEth,
                    loading: false
                });
            } else {
                this.setState({ address, loading: false });
            }
        } catch (error) {
            console.error('Failed to load wallet info:', error);
            this.setState({ loading: false });
        }
    }

    setupSubscriptions() {
        this.eventUnsubscribers = [];
        
        this.eventUnsubscribers.push(
            eventBus.on('wallet:connected', () => {
                this.loadWalletInfo();
            })
        );

        this.eventUnsubscribers.push(
            eventBus.on('wallet:disconnected', () => {
                this.setState({ address: null, balance: '0.00' });
            })
        );
    }

    async handleDisconnect() {
        try {
            await walletService.disconnect();
            // Navigate to home page
            if (window.router) {
                window.router.navigate('/');
            } else {
                window.location.href = '/';
            }
        } catch (error) {
            console.error('Failed to disconnect:', error);
        }
    }

    render() {
        if (this.state.loading) {
            return '<div class="wallet-display loading">Loading wallet info...</div>';
        }

        if (!this.state.address) {
            return ''; // Don't show if not connected
        }

        const truncatedAddress = `${this.state.address.slice(0, 6)}...${this.state.address.slice(-4)}`;

        return `
            <div class="wallet-display">
                <div class="wallet-info">
                    <span class="wallet-label">Connected:</span>
                    <span class="wallet-address">${this.escapeHtml(truncatedAddress)}</span>
                    <span class="wallet-balance">${this.state.balance} ETH</span>
                </div>
                <button class="disconnect-button" data-ref="disconnect-btn">
                    Disconnect
                </button>
            </div>
        `;
    }

    mount(element) {
        super.mount(element);
        this.setupDOMEventListeners();
    }

    setupDOMEventListeners() {
        const disconnectBtn = this.getRef('disconnect-btn', '.disconnect-button');
        if (disconnectBtn) {
            disconnectBtn.addEventListener('click', () => {
                this.handleDisconnect();
            });
        }
    }

    unmount() {
        // Clean up event listeners
        if (this.eventUnsubscribers) {
            this.eventUnsubscribers.forEach(unsub => unsub());
        }
        super.unmount();
    }

    escapeHtml(text) {
        if (!text) return '';
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }
}
```

Create src/components/WalletDisplay/WalletDisplay.css:
```css
.wallet-display {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 15px;
    padding: 15px 20px;
    background: var(--color-bg-secondary);
    border: var(--border-width) solid var(--color-border);
    border-radius: var(--border-radius-md);
    margin-bottom: 20px;
}

.wallet-info {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-grow: 1;
}

.wallet-label {
    font-weight: var(--font-weight-medium);
    color: var(--color-text-secondary);
}

.wallet-address {
    font-family: monospace;
    font-size: var(--font-size-small);
    color: var(--color-text-primary);
    background: var(--color-bg-primary);
    padding: 4px 8px;
    border-radius: var(--border-radius-sm);
}

.wallet-balance {
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    margin-left: auto;
}

.disconnect-button {
    background: var(--color-error, #ff3b30);
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: var(--border-radius-sm);
    cursor: pointer;
    font-size: var(--font-size-small);
    font-family: var(--font-primary);
    transition: background-color 0.2s;
}

.disconnect-button:hover {
    background: var(--color-error-hover, #d32f2f);
}
```

Then in ProjectDetail.js:
```javascript
import { WalletDisplay } from '../WalletDisplay/WalletDisplay.js';

// In render(), add before detail-header-container:
return `
    <div class="project-detail">
        <div class="detail-navigation">
            <button class="back-button" data-ref="back-button">← Back to Launchpad</button>
        </div>
        <div class="wallet-display-container" data-ref="wallet-display-container">
            <!-- WalletDisplay will be mounted here -->
        </div>
        <!-- ... rest ... -->
    </div>
`;

// In setupChildComponents(), add:
const walletContainer = this.getRef('wallet-display-container', '.wallet-display-container');
if (walletContainer) {
    const walletDisplay = new WalletDisplay();
    const walletElement = document.createElement('div');
    walletContainer.appendChild(walletElement);
    walletDisplay.mount(walletElement);
    this.createChild('wallet-display', walletDisplay);
}
```

Also check ERC1155/EditionGallery.js and ERC404/ERC404TradingInterface.js for any
WalletConnector usage and remove it.

TASK 6: FIX WALLETCONNECTOR ERRORS ON HOME PAGE
------------------------------------------------

Problem:
WalletConnector is trying to show trading interface (showTradingInterface) when wallet
connects on the home page, but the bonding interface container doesn't exist there.
This causes errors.

Files to modify:
- src/components/WalletConnector/WalletConnector.js

Solution:
1. Check if we're on the CULT EXEC page before calling showTradingInterface
2. Only show trading interface if bondingCurveInterface element exists
3. Add a check for the current route/page context

Implementation:
```javascript
// In WalletConnector.js, modify showTradingInterface method:
async showTradingInterface(connectedAddress, ethersProvider, signer) {
    // Check if we're on the CULT EXEC page
    const bondingInterface = document.getElementById('bondingCurveInterface');
    if (!bondingInterface) {
        // Not on CULT EXEC page, don't try to show trading interface
        console.log('Not on CULT EXEC page, skipping trading interface initialization');
        return;
    }

    // Also check if contractInterface exists
    const contractInterface = document.getElementById('contractInterface');
    if (!contractInterface) {
        console.log('Contract interface not found, skipping trading interface initialization');
        return;
    }

    // Rest of existing code...
}
```

Also check the event handler that calls this:
```javascript
// Around line 309, modify the wallet:connected handler:
this.eventUnsubscribers.push(eventBus.on('wallet:connected', async (data) => {
    // ... existing code ...
    
    // Only show trading interface if on CULT EXEC page
    const bondingInterface = document.getElementById('bondingCurveInterface');
    if (bondingInterface) {
        this.showTradingInterface(data.address, data.ethersProvider, data.signer);
    }
}));
```

TASK 7: CONSOLIDATE DOCUMENTATION INTO ABOUT PAGE
--------------------------------------------------

Problem:
Documentation is scattered across multiple markdown files:
- LAUNCHPAD_TRANSITION.md
- LAUNCHPAD_ANALYSIS.md
- MOCK_SYSTEM_DESIGN.md
- CULT_EXEC_SHELTERING.md
- IMPLEMENTATION_ROADMAP.md
- PLANNING_SUMMARY.md
- CONTRACT_REQUIREMENTS.md
- LAUNCHPAD_REASSESSMENT.md

These should be consolidated into the About/Documentation page for users, and
technical details should be moved to a single technical documentation file.

Files to modify:
- src/components/Documentation/Documentation.js
- Create: TECHNICAL_DOCUMENTATION.md (for developers)
- Delete or archive: The scattered planning documents

Solution:
1. Read all the documentation files
2. Extract user-facing information for the About page
3. Consolidate technical details into TECHNICAL_DOCUMENTATION.md
4. Update Documentation.js with comprehensive, user-friendly content
5. Archive or delete the old planning documents (or move to /docs/archive/)

Content to include in About page:
- What is ms2.fun (from various docs)
- How it works (decentralized launchpad)
- Factory system explanation
- Contract requirements (simplified for users)
- Community and governance (CULT EXEC control)
- FAQ (expand existing)
- Links to contracts, GitHub, etc.

Implementation:
1. Read all the markdown files listed above
2. Extract key information
3. Rewrite in user-friendly language
4. Update Documentation.js
5. Create TECHNICAL_DOCUMENTATION.md with technical details
6. Move old docs to /docs/archive/ or delete them

TASK 8: REMOVE BACKWARD COMPATIBILITY DEPENDENCIES
----------------------------------------------------

Problem:
There may still be references to old address-based routing, old service names,
or backward compatibility code that's no longer needed.

Files to check:
- src/core/Router.js (check for old route patterns)
- src/routes/ProjectDetail.js (check for old /project/:id handling)
- src/services/ServiceFactory.js (check for old service references)
- Any files importing BlockchainService instead of ProjectService

Solution:
1. Search for deprecated patterns:
   - `/project/:id` route handling (keep only for true backward compat if needed)
   - `BlockchainService` imports (should only be in CULT EXEC code)
   - `tradingStore` usage outside CULT EXEC
   - Old service factory patterns

2. Remove or clearly mark as CULT EXEC only:
   - Any BlockchainService usage outside CULT EXEC routes
   - Any tradingStore usage outside CULT EXEC routes
   - Old route patterns that aren't needed

3. Ensure clean separation:
   - CULT EXEC uses: BlockchainService, tradingStore, TradingInterface
   - Launchpad uses: ProjectService, projectStore, ContractAdapters

Implementation:
```bash
# Search for these patterns:
grep -r "BlockchainService" src/ --exclude-dir=node_modules
grep -r "tradingStore" src/ --exclude-dir=node_modules
grep -r "/project/:" src/
```

Then:
1. Keep BlockchainService only in:
   - src/routes/CultExecsPage.js
   - src/components/TradingInterface/ (CULT EXEC specific)
   - src/components/WalletConnector/WalletConnector.js (only for CULT EXEC)

2. Remove any other references or clearly mark them as deprecated.

================================================================================
TESTING REQUIREMENTS
================================================================================

After implementation, verify:

1. Styling:
   - [ ] Home page has white/light background (not black)
   - [ ] Project detail pages have white/light background
   - [ ] CULT EXEC page still has black background
   - [ ] Project cards have uniform heights on home page
   - [ ] Project header titles use RedHat font (not monospace)

2. Functionality:
   - [ ] Back button appears on instance pages
   - [ ] Back button navigates to home page
   - [ ] Wallet display shows on instance pages (not wallet connector)
   - [ ] Wallet display shows address and balance
   - [ ] Disconnect button works and navigates to home
   - [ ] No wallet connection errors on home page
   - [ ] CULT EXEC page still works with WalletConnector

3. Documentation:
   - [ ] About page has comprehensive, user-friendly content
   - [ ] Technical documentation consolidated
   - [ ] Old planning docs archived or removed

4. Code Quality:
   - [ ] No backward compatibility code outside CULT EXEC
   - [ ] Clean separation between CULT EXEC and launchpad code
   - [ ] No console errors

================================================================================
SUCCESS CRITERIA
================================================================================

✅ All pages have appropriate backgrounds (white for launchpad, black for CULT EXEC)
✅ Project cards have uniform heights
✅ Project titles use RedHat font
✅ Back button on all instance pages
✅ Wallet display (not connector) on instance pages
✅ No wallet connection errors
✅ Documentation consolidated
✅ Backward compatibility removed (except CULT EXEC)

================================================================================
REFERENCE FILES
================================================================================

- style.css (black background source)
- src/routes/home.css (card styling)
- src/components/ProjectDetail/ProjectHeader.js (title font)
- src/components/ProjectDetail/ProjectDetail.js (back button, wallet display)
- src/components/WalletConnector/WalletConnector.js (trading interface errors)
- src/components/Documentation/Documentation.js (consolidation target)
- All markdown files in root (documentation sources)

================================================================================
START IMPLEMENTATION
================================================================================

Begin with Task 1 (black background), then proceed through each task systematically.
Test after each major change to ensure nothing breaks.

The goal is a polished, consistent launchpad with clean separation between
CULT EXEC and the new multi-project system.

Good luck!

